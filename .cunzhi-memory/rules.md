# 开发规范和规则

- 用户反馈界面问题：1.顶部标题"AI换脸【秘灵】"文字被截断 2.执行日志边距过大导致内容超出容器 3.状态栏文字过大 4.底部系统状态文字仍然太小
- CUDA版本兼容性规则：CUDA 12.3 + ONNX Runtime 1.17.1 = 不兼容，会导致LoadLibrary failed with error 126。推荐解决方案：使用conda环境隔离，安装CUDA 11.8 + ONNX Runtime兼容版本，或接受CPU模式运行。
- 用户纠正MCP使用频率：不要每次都调用记忆MCP和交互MCP。记忆MCP只在重要阶段完成时调用，交互MCP只在需要用户确认或告知用户完成情况时调用，不要频繁使用
- 界面布局优化完成：1.GPU状态文字移至底部状态栏 2.所有浏览按钮宽度统一为80px 3.控制面板按钮缩小(5px 10px, 11px字体, 26-30px高度, 80-120px宽度) 4.执行日志面板边距调整为15px与上方模块一致，最小高度250px与右侧对齐 5.移除底部系统信息模块，禁用系统监控功能 6.背景来源按钮应用统一样式
- 修复关键问题：1.QBasicTimer错误-在closeEvent中添加monitor_timer.stop()避免线程定时器错误 2.背景来源按钮显示不全-设置按钮容器最小宽度180px，调整列宽比例(0:2:1)，所有按钮添加Qt.AlignLeft|Qt.AlignVCenter对齐方式，确保按钮完整显示且与输入框对齐
- 字体和布局优化完成：1.控制面板按钮字体改为16px，尺寸调整为padding 6px 10px，高度32-36px，宽度90-140px 2.多人脸选择字体改为16px 3.底部状态栏所有元素字体统一改为16px：应用信息、进度标签、进度条、状态文本、GPU加速选项、GPU状态标签、所有按钮 4.替换模式行合并到背景替换行，启用背景替换和模式选择在同一行，节省空间，背景来源行号从5改为4
- 布局高度优化完成：1.文件选择区域设置固定高度280-320px，防止被挤压 2.控制面板设置固定高度80-100px，保持紧凑 3.执行日志区域移除高度限制，设置为自适应高度，使用QSizePolicy.Expanding撑满剩余空间 4.左侧布局中日志面板添加拉伸因子1，确保占用剩余空间。现在文件选择和控制面板保持稳定高度，日志区域自适应填充
- 布局高度进一步优化：1.文件选择区域高度增加到350-380px，确保内容完整显示 2.顶部标题设置固定高度40px，不参与自适应 3.底部状态栏设置固定高度60px，不参与自适应 4.主分割器在主布局中添加拉伸因子1，占用剩余空间。现在只有执行日志区域会自适应高度，其他区域都是固定高度，确保界面稳定性
- 模型下载必须在后台线程进行，不能阻塞GUI主线程，需要显示下载进度和状态信息
