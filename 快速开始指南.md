# AI换脸工具 快速开始指南

## 🚀 3分钟快速体验

### 前提条件
- Windows 10/11, Ubuntu 20.04+, 或 macOS 10.15+
- Python 3.8-3.11 (推荐3.10)
- 4GB+ 内存和3GB存储空间
- 稳定的网络连接 (用于下载模型)

## 方式一：Windows MSI安装包 (最简单)

### 1. 下载安装包
- 下载 `AI换脸工具_v1.0.0_安装包.zip`
- 解压到任意目录

### 2. 运行安装程序
```bash
# 双击运行安装脚本
安装.bat
```

安装程序会自动：
- ✅ 检查Python环境
- ✅ 智能检测已安装的依赖包
- ✅ 只安装缺失的组件
- ✅ 创建桌面快捷方式
- ✅ 显示详细的安装进度

### 3. 启动程序
- 双击桌面快捷方式 "AI换脸工具"
- 或运行安装目录中的 "启动AI换脸工具.bat"

## 方式二：源码安装

### 1. 克隆项目
```bash
git clone https://github.com/your-repo/ai-face-swap.git
cd ai-face-swap
```

### 2. 创建虚拟环境 (可选但推荐)
```bash
python -m venv env

# Windows
.\env\Scripts\activate

# Linux/macOS
source env/bin/activate
```

### 3. 安装依赖
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 4. 启动应用
```bash
# 启动GUI界面 (推荐)
python main_pyqt.py

# 或查看命令行帮助
python main_pyqt.py --help
```

## 🎯 第一次使用

### 1. 启动程序
```bash
# 源码安装用户
python main_pyqt.py

# MSI安装用户
# 双击桌面快捷方式或运行启动脚本
```

### 2. 自动模型下载
首次启动时，程序会：
- 🔍 自动检测缺失的AI模型文件
- 📥 弹出下载管理器界面
- 📊 显示需要下载的文件列表
- 🚀 点击"开始下载"自动获取模型 (约800MB)
- ⏱️ 显示实时下载进度，界面保持响应

### 3. 准备素材
- **源人脸图片**: 清晰的正面人脸照片 (JPG/PNG/BMP)
- **目标文件**: 要换脸的图片或视频 (支持多种格式)

### 4. 使用界面
1. **选择源人脸**: 点击按钮选择源人脸图片
2. **选择目标文件**: 选择目标图片或视频
3. **设置输出路径**: 自动生成或手动修改
4. **开始处理**: 点击"🚀 开始换脸"按钮
5. **查看进度**: 实时进度条和状态显示
6. **查看结果**: 完成后自动提示，可直接打开结果文件夹

## 📋 常用命令速查

### GUI界面操作
```bash
# 启动主界面
python main_pyqt.py

# 检查环境和依赖
python scripts/check_environment.py

# 手动下载模型
python scripts/simple_model_getter.py
```

### 命令行处理
```bash
# 图像换脸
python main_pyqt.py --source face.jpg --target photo.jpg --output result.jpg

# 视频换脸
python main_pyqt.py --source face.jpg --target video.mp4 --output result.mp4

# 查看帮助
python main_pyqt.py --help
```

### 工具脚本
```bash
# 批量处理 (如果有批量脚本)
python scripts/batch_process.py --source face.jpg --input-dir videos/ --output-dir results/

# 验证模型文件
python scripts/verify_models.py

# 安装GPU支持
python scripts/install_gpu_support.py
```

### 实时换脸
```bash
# 摄像头实时换脸
python -m dlc_batch.cli swap-live --source face.jpg --camera 0

# 显示预览窗口
python -m dlc_batch.cli swap-live --source face.jpg --camera 0 --show-window

# 保存录制视频
python -m dlc_batch.cli swap-live --source face.jpg --camera 0 --record output.mp4
```

## ⚙️ 常用参数说明

### 质量控制参数
```bash
--quality fast      # 快速模式: 低分辨率处理，速度优先
--quality balanced  # 平衡模式: 中等分辨率，质量与速度平衡 (默认)
--quality high      # 高质量模式: 高分辨率处理，质量优先
```

### 检测参数
```bash
--conf-threshold 0.5    # 人脸检测置信度阈值 (0.1-0.9)
--min-face-size 64      # 最小人脸尺寸 (像素)
--max-faces 5           # 最大检测人脸数量
```

### 性能参数
```bash
--providers cuda        # 使用GPU加速 (默认)
--providers cpu         # 使用CPU处理
--batch-size 1          # 批处理大小
--threads 4             # 处理线程数
```

### 输出控制
```bash
--no-audio             # 不保留音轨
--fps 30               # 输出视频帧率
--codec h264           # 视频编码格式
--bitrate 5000k        # 视频比特率
```

## 🔧 故障排除

### 常见问题及解决方案

#### 1. GPU不可用
```bash
# 检查CUDA是否可用
python -c "import torch; print(torch.cuda.is_available())"

# 如果返回False，使用CPU模式
python -m dlc_batch.cli swap-video --providers cpu --source face.jpg --input video.mp4 --output result.mp4
```

#### 2. 内存不足
```bash
# 降低处理分辨率
python -m dlc_batch.cli swap-video --quality fast --source face.jpg --input video.mp4 --output result.mp4

# 减少批处理大小
python -m dlc_batch.cli swap-video --batch-size 1 --source face.jpg --input video.mp4 --output result.mp4
```

#### 3. 模型加载失败
```bash
# 重新下载模型
python scripts/download_models.py --force

# 验证模型文件
python scripts/verify_models.py
```

#### 4. 视频编码错误
```bash
# 检查FFmpeg安装
ffmpeg -version

# 使用不同编码器
python -m dlc_batch.cli swap-video --codec libx264 --source face.jpg --input video.mp4 --output result.mp4
```

### 性能优化建议

#### GPU用户
```bash
# 最佳性能配置
python -m dlc_batch.cli swap-video \
    --providers cuda \
    --quality balanced \
    --batch-size 4 \
    --source face.jpg \
    --input video.mp4 \
    --output result.mp4
```

#### CPU用户
```bash
# CPU优化配置
python -m dlc_batch.cli swap-video \
    --providers cpu \
    --quality fast \
    --threads 8 \
    --source face.jpg \
    --input video.mp4 \
    --output result.mp4
```

## 📊 性能基准

### 参考性能 (RTX 3060)
- **1080p视频**: ~25fps
- **720p视频**: ~40fps
- **480p视频**: ~60fps

### 参考性能 (CPU i7-10700K)
- **480p视频**: ~8fps
- **360p视频**: ~15fps

## 🎨 高级用法示例

### 多人脸处理
```bash
# 替换所有人脸
python -m dlc_batch.cli swap-video --target all --source face.jpg --input video.mp4 --output result.mp4

# 仅替换最大人脸
python -m dlc_batch.cli swap-video --target largest --source face.jpg --input video.mp4 --output result.mp4

# 身份映射 (不同人脸使用不同源脸)
python -m dlc_batch.cli swap-video --map "person1=face1.jpg,person2=face2.jpg" --input video.mp4 --output result.mp4
```

### 画质增强
```bash
# 启用人脸增强
python -m dlc_batch.cli swap-video --enhance-face --source face.jpg --input video.mp4 --output result.mp4

# 启用颜色匹配
python -m dlc_batch.cli swap-video --color-correction --source face.jpg --input video.mp4 --output result.mp4

# 完整画质优化
python -m dlc_batch.cli swap-video \
    --enhance-face \
    --color-correction \
    --use-segmentation \
    --blend-ratio 0.8 \
    --source face.jpg \
    --input video.mp4 \
    --output result.mp4
```

### 实时推流
```bash
# RTMP推流
python -m dlc_batch.cli swap-live \
    --source face.jpg \
    --camera 0 \
    --rtmp rtmp://live.example.com/stream/key

# YouTube直播
python -m dlc_batch.cli swap-live \
    --source face.jpg \
    --camera 0 \
    --rtmp rtmp://a.rtmp.youtube.com/live2/YOUR_STREAM_KEY
```

## 📚 更多资源

- 📖 [完整操作手册](操作手册.md)
- 📋 [需求文档](需求文档.md)
- 📊 [项目进度](项目进度跟踪.md)
- 🐛 [问题反馈](https://github.com/your-repo/deep-live-cam/issues)
- 💬 [讨论区](https://github.com/your-repo/deep-live-cam/discussions)

## ⚠️ 重要提醒

### 合规使用
- ✅ 确保对所有使用的人脸图像拥有合法授权
- ✅ 仅在合规场景下使用本工具
- ✅ 遵守当地法律法规和平台政策
- ❌ 禁止用于欺诈、诈骗等非法用途
- ❌ 禁止未经授权使用他人肖像

### 技术限制
- 极端光照条件下效果可能下降
- 大角度侧脸或遮挡严重时效果有限
- 处理超高分辨率视频需要更强硬件支持

---

**需要帮助?** 查看 [操作手册](操作手册.md) 或提交 [Issue](https://github.com/your-repo/deep-live-cam/issues)
